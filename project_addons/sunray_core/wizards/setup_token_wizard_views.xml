<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- Wizard Form View -->
    <record id="view_sunray_setup_token_wizard_form" model="ir.ui.view">
        <field name="name">sunray.setup.token.wizard.form</field>
        <field name="model">sunray.setup.token.wizard</field>
        <field name="arch" type="xml">
            <form>
                <!-- Show input fields when no token is generated yet -->
                <group invisible="generated_token">
                    <field name="user_id" options="{'no_create': True}"/>
                    <field name="host_id" options="{'no_create': True}"/>
                    <field name="device_name" placeholder="e.g., John's Laptop, iPhone 15"/>
                    <field name="validity_hours"/>
                    <field name="max_uses"/>
                    <field name="allowed_cidrs" widget="text" placeholder="Optional: IP addresses or CIDR ranges per line&#10;Examples:&#10;192.168.1.100&#10;192.168.1.100/32&#10;10.0.0.0/8"/>
                </group>
                
                <!-- Show token and instructions when generated -->
                <div invisible="not generated_token">
                    <!-- Token display with monospace font for readability -->
                    <div class="alert alert-info" role="alert">
                        <h5><i class="fa fa-key"/> Setup Token</h5>
                        <div style="font-family: 'Courier New', monospace; font-size: 18px; font-weight: bold; letter-spacing: 1px; background: #f8f9fa; padding: 10px; border: 1px dashed #6c757d; border-radius: 4px; text-align: center; margin: 10px 0;">
                            <field name="generated_token" readonly="1" nolabel="1"/>
                        </div>
                        <small class="text-muted"><i class="fa fa-info-circle"/> Click to select, then copy (Ctrl+C)</small>
                    </div>
                    
                    <!-- Instructions -->
                    <div class="alert alert-success" role="alert">
                        <field name="token_display" readonly="1" widget="text" nolabel="1"/>
                    </div>
                </div>
                
                <!-- Hidden field to track state -->
                <field name="generated_token" invisible="1"/>
                
                <footer>
                    <button name="generate_token" string="Generate Token" type="object" class="btn-primary" invisible="generated_token"/>
                    <button string="Close" class="btn-primary" special="cancel" invisible="not generated_token"/>
                    <button string="Cancel" class="btn-secondary" special="cancel" invisible="generated_token"/>
                </footer>
            </form>
        </field>
    </record>
    
    <!-- Wizard Action -->
    <record id="action_sunray_setup_token_wizard" model="ir.actions.act_window">
        <field name="name">Generate Setup Token</field>
        <field name="res_model">sunray.setup.token.wizard</field>
        <field name="view_mode">form</field>
        <field name="target">new</field>
    </record>
</odoo>